---
layout: post
title: Linux traceroute 命令
key: 20230301
tags: 网络安全
---

[欢迎访问Maihill技术博客，欢迎转载和分享](https://blog.maihill.com "Maihill技术博客")

# Linux  traceroute 命令

## Linux traceroute 命令

### traceroute命令安装

    yum install traceroute

### traceroute命令介绍
> traceroute是用来检测发出数据包的主机到目标主机之间所经过的网关数量的工具。traceroute的原理是试图以最小的TTL（存活时间）发出探测包来跟踪数据包到达目标主机所经过的网关，然后监听一个来自网关ICMP的应答。发送数据包的大小默认为38个字节。

### tracroute执行过程
> 首先它发送一份TTL字段为1的IP数据包给目的主机，处理这个数据包的第一个路由器将TTL值减1，然后丢弃该数据报，并给源主机发送一个ICMP报文（“超时”信息，这个报文包含了路由器的IP地址，这样就得到了第一个路由器的地址），然后traceroute发送一个TTL为2的数据包来得到第二个路由器的IP地址，继续这个过程，直至这个数据包到达目的主机。
## Linux tracroute 命令运用实例
### 追踪baidu的路由
    traceroute www.baidu.com
     1  gateway (192.168.100.254)  2.875 ms  2.819 ms  2.803 ms
     2  118.112.177.1 (118.112.177.1)  2.968 ms  3.228 ms  3.552 ms
     3  118.116.49.189 (118.116.49.189)  7.830 ms  7.804 ms  7.774 ms
     4  * 61.139.121.33 (61.139.121.33)  4.564 ms 110.188.6.25 (110.188.6.25)  4.450 ms
     5  202.97.101.69 (202.97.101.69)  30.751 ms 202.97.29.25 (202.97.29.25)  28.893 ms 202.97.29.21 (202.97.29.21)  37.859 ms
     6  * * *
     7  121.14.14.162 (121.14.14.162)  37.416 ms  44.854 ms 106.96.135.219.broad.fs.gd.dynamic.163data.com.cn (219.135.96.106)  46.479 ms
     8  14.29.121.182 (14.29.121.182)  38.847 ms 14.29.117.246 (14.29.117.246)  31.931 ms 14.215.32.134 (14.215.32.134)  34.462 ms
     9  * * *
    10  * * *
    11  * * *
    12  * * *
    13  * * *
    14  * * *
    15  * * *
    16  * * *
    17  * * *
    18  * * *
    19  * * *
    20  * * *
    21  * * *
    22  * * *
    23  * * *
    24  * * *
    25  * * *
    26  * * *
    27  * * *
    28  * * *
    29  * * *
    30  * * *
### 设置显示跳数
    traceroute -m 4 www.baidu.com
    traceroute to www.baidu.com (14.215.177.38), 4 hops max, 60 byte packets
    1  gateway (192.168.100.254)  1.862 ms  1.796 ms  2.870 ms
    2  118.112.177.1 (118.112.177.1)  3.758 ms  3.993 ms  4.098 ms
    3  118.116.49.189 (118.116.49.189)  4.528 ms  4.602 ms  4.670 ms
    4  * 61.139.121.17 (61.139.121.17)  3.683 ms 61.139.121.37 (61.139.121.37)  4.128 ms
### 显示IP不显示域名
    traceroute -n www.baidu.com
     1  192.168.100.254  2.079 ms  2.031 ms  2.026 ms
     2  118.112.177.1  3.498 ms  3.614 ms  3.774 ms
     3  118.116.49.189  4.238 ms  4.497 ms  4.612 ms
     4  110.188.6.45  3.656 ms 171.208.199.65  3.911 ms 61.139.121.17  3.881 ms
     5  202.97.29.21  28.120 ms 202.97.101.65  30.130 ms 202.97.29.29  27.954 ms
     6  * * *
     7  219.135.96.106  34.361 ms 121.14.14.138  30.285 ms 219.135.96.106  33.656 ms
     8  14.29.121.202  32.848 ms 14.215.32.110  37.459 ms 121.14.67.146  27.871 ms
### 设置UD端口
    traceroute -p 8080 www.baidu.com
    traceroute to www.baidu.com (14.215.177.38), 30 hops max, 60 byte packets
    1  gateway (192.168.100.254)  1.975 ms  1.926 ms  1.850 ms
    2  118.112.177.1 (118.112.177.1)  2.806 ms  4.019 ms  4.139 ms
    3  * * *
    4  * * 110.188.6.17 (110.188.6.17)  3.721 ms
    5  * * *
    6  * * *
    7  106.96.135.219.broad.fs.gd.dynamic.163data.com.cn (219.135.96.106)  35.983 ms 121.14.14.162 (121.14.14.162)  40.103 ms 106.96.135.219.broad.fs.gd.dynamic.163data.com.cn (219.135.96.106)  35.690 ms
    8  14.215.32.134 (14.215.32.134)  32.392 ms 14.215.32.98 (14.215.32.98)  35.565 ms 14.215.32.126 (14.215.32.126)  30.585 ms
### 设置等待远端主机回包的时间
    traceroute -w 5 www.baidu.com
    traceroute to www.baidu.com (14.215.177.38), 30 hops max, 60 byte packets
    1  gateway (192.168.100.254)  2.591 ms  2.554 ms  2.540 ms
    2  118.112.177.1 (118.112.177.1)  3.427 ms  3.490 ms  3.627 ms
    3  118.116.49.189 (118.116.49.189)  4.456 ms  5.367 ms  5.337 ms
    4  61.139.121.17 (61.139.121.17)  3.534 ms 110.188.6.37 (110.188.6.37)  3.497 ms 110.188.6.41 (110.188.6.41)  3.345 ms
    5  202.97.29.25 (202.97.29.25)  28.058 ms 202.97.101.77 (202.97.101.77)  32.659 ms  32.628 ms
    6  * * *
    7  106.96.135.219.broad.fs.gd.dynamic.163data.com.cn (219.135.96.106)  35.561 ms  34.227 ms  33.686 ms
    8  14.29.121.182 (14.29.121.182)  36.934 ms 14.29.117.246 (14.29.117.246)  34.473 ms 14.215.32.102 (14.215.32.102)  38.125 ms
